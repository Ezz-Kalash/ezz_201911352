#!/bin/bash

REPO="/srv/samba/ezz_201911352"
LOG="/var/log/samba_backup.log"  

mm() {
    echo "$(date +'%Y-%m-%d %H:%M:%S') $1" >> "$LOG"
}

backup() {
    source githubs
	echo "the files have been uploded to github "


    if [ $? -eq 0 ]; then
        mm "Backup successfully completed."
    else
        mm "Backup failed."
    fi
}

inotifywait -m -r -e create,modify,delete "$REPO" | while read -r directory events filename; do
   
    mm "Change detected:$filename"
   # if id -nG "$USER" | grep -qw "$GROUPS";then   
    backup
   # fi
done
